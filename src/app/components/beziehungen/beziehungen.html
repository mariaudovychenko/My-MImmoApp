<form (ngSubmit)="addBeziehung()" #beziehungForm="ngForm" class="max-w-xl mx-auto mt-10 p-4 space-y-6">

    <!-- Fehlermeldung -->
  <div *ngIf="fehlerMeldung?.length" class="text-red-600 font-medium">
    {{ fehlerMeldung }}
  </div>
  <!-- Immobilie auswählen -->
  <div>
    <label class="block mb-1 font-medium">Immobilie</label>
    <select [(ngModel)]="beziehung.immobilienId" name="immobilienId" required class="border p-2 w-full rounded-md">
      <option value="" disabled selected>Bitte auswählen</option>
      <option *ngFor="let immo of immobilienListe" [value]="immo.id">
        {{ immo.description }} - {{ immo.address }}
      </option>
    </select>
  </div>

  <!-- Kontakt auswählen -->
  <div>
    <label class="block mb-1 font-medium">Kontakt</label>
    <select [(ngModel)]="beziehung.kontaktId" name="kontaktId" required class="border p-2 w-full rounded-md">
      <option value="" disabled selected>Bitte auswählen</option>
      <option *ngFor="let kontakt of kontaktListe" [value]="kontakt.id">
        {{ kontakt.name }} - {{ kontakt.address }}
      </option>
    </select>
  </div>

  <!-- Beziehungstyp -->
  <div>
    <label class="block mb-1 font-medium">Beziehungstyp</label>
    <select [(ngModel)]="beziehung.typ" name="typ" required class="border p-2 w-full rounded-md">
      <option value="" disabled selected>Bitte auswählen</option>
      <option value="Eigentümer">Eigentümer</option>
      <option value="Mieter">Mieter</option>
      <option value="Dienstleister">Dienstleister</option>
    </select>
  </div>

  <!-- Zusatzfeld für Dienstleister -->
  <div *ngIf="beziehung.typ === 'Dienstleister'">
    <label class="block mb-1 font-medium">Dienstleistungen</label>
    <input
      [(ngModel)]="beziehung.dienstleistungen"
      name="dienstleistungen"
      required
      class="border p-2 w-full rounded-md"
      placeholder="z. B. Reinigung, Hausmeister"
    />
  </div>

  <!-- Zeitraum -->
  <div class="flex gap-4">
    <div class="flex-1">
      <label class="block mb-1 font-medium">Startdatum</label>
      <input
        [(ngModel)]="beziehung.start"
        name="start"
        type="date"
        required
        class="border p-2 w-full rounded-md"
      />
    </div>
    <div class="flex-1">
      <label class="block mb-1 font-medium">Enddatum</label>
      <input
        [(ngModel)]="beziehung.ende"
        name="ende"
        type="date"
        required
        class="border p-2 w-full rounded-md"
      />
    </div>
  </div>

  <!-- Fehlermeldung -->
  <div *ngIf="fehlerMeldung?.length" class="text-red-600 text-sm">
    {{ fehlerMeldung }}
  </div>

  <!-- Button -->
  <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-md">
    Beziehung speichern
  </button>
</form>

<!-- Liste aller Beziehungen -->
<ul class="mt-10 max-w-xl mx-auto p-4 space-y-4">
  <li *ngFor="let b of beziehungenListe" class="border p-4 rounded-md">
    <div><strong>Immobilie:</strong> {{ getImmobilie(b.immobilienId)?.description }}</div>
    <div><strong>Kontakt:</strong> {{ getKontakt(b.kontaktId)?.name }}</div>
    <div><strong>Typ:</strong> {{ b.typ }}</div>
    <div><strong>Zeitraum:</strong> {{ b.start }} – {{ b.ende }}</div>
    <div *ngIf="b.typ === 'Dienstleister'"><strong>Dienstleistungen:</strong> {{ b.dienstleistungen }}</div>
    <button (click)="deleteBeziehung(b)" class="mt-2 text-red-600 text-sm">Löschen</button>
  </li>
</ul>
